# CX

CX is a component-based framework that manipulates the DOM directly.
It is based on the [DX](https://github.com/xtompie/dx) architecture.

## Installation

Copy content of `cx.js` into your javascript code.

## Documentation

### Component

A component is defined as an element that possesses a `component` attribute, which also contains the name of the component. These names are unique and globally recognized within the application.

Functions related to a component are encapsulated within an object named after the component itself. It's possible for a component's name to act as a reference to an object nested within another object, for example, `app.module.component`.

```html
<script>
const counter = (function() {
    function increment() {
        const v = this.c().one('[counter-value]');
        v.textContent = parseInt(v.textContent) + 1;
    }
    return {
        increment,
    }
})();
</script>
<div component="counter">
    <span counter-value>0</span>
    <button onclick="this.fn.increment()">+1</button>
</div>
```

### View

Depending on the requirements, a view can be generated by the backend, as demonstrated in the example above, or dynamically rendered on the client-side e.g.:

```html
<!-- component definition -->
<script>
const counter = (function() {
    function init() {
        this.append(document.one('[counter-tpl]').content.cloneNode(true));
    }
    // ...
    return {
        init,
        // ..
    }
})();
</script>
<template counter-tpl>
    <span counter-value>0</span>
    <button onclick="this.fn.increment()">+1</button>
</div>

<!-- use -->
<div component="counter">
    <script>document.currentScript.c().fn.init()</script>
</div>

<!-- or -->
<script>
    let counter = document.createElement('div');
    counter.attr('component', 'counter');
    document.body.appendChild(counter);
    counter.fn.init();
</script>
```

Initialization of a component is typically handled by the entity responsible for the component, often the parent element or component.

### Function

```html
<script>
const counter = (function() {
    function increment() {
        // this refers to button
        // ...
    }
    // ...
})();
</script>
<div component="counter">
    <!-- ... -->
    <button onclick="this.fn.increment()">+1</button>
</div>
```

In the context of a function, the keyword `this` refers to the DOM element from which the function was invoked.

### Emmit

Components are capable of emitting a callback. The callback must be a function.

```html
<script>
const counter = (function() {
    function increment() {
        // ...
        this.emmit('onchange', 42)
    }
    // ...
})();
</script>
<div component="counter" onchnage="(v) => console.log(v)">
    <!-- ... -->
</div>
```

### Navigate

Helper function to navigate throught DOM:

- `document|HTMLElement.one(selector)` - alias to querySelector
- `document|HTMLElement.all(selector)` - alias to querySelectorAll but returns an Array
- `HTMLElement.up(selector)` - if selector is set the alias to closest otherwise parentNode.

Helper function to navigate throught components:

- `HTMLElement.c()` - finds current component DOMElement.
- `document|HTMLElement.onec(name)` - same as `one` but for components
- `document|HTMLElement.allc(name)` - same as `all` but for components
- `HTMLElement.upc(name)` - same as `closest` but for components

Helper function are simple and small check their implementation.

```html
<div component="parent">
    <div component="child" onchange="() => this.up().fn.childDidChange(this)">
    </div>
</div>
```

In the example provided, `this` is referencing the child component. To call a function belonging to a parent, you need to leave the child context by going one level higher in the DOM hierarchy. Alternatively, the parent function can be called using the syntax `() => this.c('parent').fn.childDidChange(this)`.

## Examples

- [counter](./counter/)
- [todolist](./todolist/)

To run examples execute `composer serve`
